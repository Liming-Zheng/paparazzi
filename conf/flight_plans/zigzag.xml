<!DOCTYPE procedure SYSTEM "procedure.dtd">

<procedure>
  <param name="rad" default_value="30"/>
  <param name="alt"/>

  <waypoints>
    <waypoint name="LANDING" x="0" y="40" alt="0"/>
    <waypoint name="TARGET" x="-170" y="100" alt="0"/>
    <waypoint name="WP1" x="-160" y="20" alt="0"/>
    <waypoint name="WP2" x="-70" y="110" alt="0"/>
  </waypoints>

  <blocks>
    <block NAME="takeoff">
      <exception COND="(RcEvent1())" DEROUTE="back"/>
      <exception COND="(RcEvent2())" DEROUTE="target"/>
      <heading vmode="gaz" gaz="0.8" pitch="0.15" course="260" until="(estimator_flight_time > 10)"/>
      <go wp="WP1" alt="alt"/>
      <go wp="WP2" alt="alt"/>
      <deroute block="target"/>
    </block>

    <block NAME="target">
      <exception COND="(RcEvent1())" DEROUTE="back"/>
      <exception COND="(RcEvent2())" DEROUTE="carrot"/>
      <circle WP="TARGET" RADIUS="rad" alt="alt"/>
    </block>

    <block NAME="carrot">
      <exception COND="(RcEvent1())" DEROUTE="back"/>
      <exception COND="(RcEvent2())" DEROUTE="target"/>
      <xyz radius="rad"/>
    </block>

    <block NAME="back">
      <exception COND="(RcEvent1())" DEROUTE="takeoff"/>
      <go wp="LANDING" alt="GROUND_ALT"/>
      <deroute block="end"/>
    </block>
  </blocks>
</procedure>
