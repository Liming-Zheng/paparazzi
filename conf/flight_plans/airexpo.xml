<flight_plan SECURITY_HEIGHT="25" lat0="43.449300" lon0="1.266300" ground_alt="189" qfu="270" alt="250" max_dist_from_home="450" name="AirExpo">
  <rc_control>
    <mode NAME="AUTO1">
      <setting VAR="ir_pitch_neutral" RANGE="60." RC="gain_1_up" TYPE="int16"/>
      <setting VAR="ir_roll_neutral" RANGE="-60." RC="gain_1_down" TYPE="int16"/>
    </mode>
    <mode NAME="AUTO2">
      <setting VAR="course_pgain" RANGE="0.1" RC="gain_1_up" TYPE="float"/>
      <setting VAR="pitch_of_roll" RANGE=".2" RC="gain_1_down" TYPE="float"/>
    </mode>
  </rc_control>
  <dl_settings>
    <dl_setting VAR="ir_roll_neutral" MAX="0.2" STEP="0.01" MIN="-0.2"/>
    <dl_setting VAR="ir_pitch_neutral" MAX="0.2" STEP="0.01" MIN="-0.2"/>
    <dl_setting VAR="roll_pgain" MAX="15000" STEP="100" MIN="5000"/>
    <dl_setting VAR="pitch_pgain" MAX="20000" STEP="100" MIN="10000"/>
    <dl_setting VAR="course_pgain" MAX="-0.1" STEP="0.05" MIN="-1"/>
  </dl_settings>
  <waypoints>
    <waypoint name="HOME" x="-271.330646709" y="43.9746582191" alt="250."/>
    <waypoint name="TX_W" x="-547.990853153" y="186.049398384" alt="250."/>
    <waypoint name="TX_E" x="-99.807450281" y="-37.0290245749" alt="250."/>
    <waypoint name="NW" x="-525.280122141" y="218.618616053" alt="250."/>
  </waypoints>
  <blocks>
    <block NAME="init">
      <while COND="(!launch)"/>
      <heading GAZ="0.8" PITCH="0.15" COURSE="QFU" UNTIL="(estimator_flight_time > 8)" VMODE="gaz"/>
      <heading PITCH="0.15" CLIMB="3.0" COURSE="QFU" UNTIL="(estimator_z > SECURITY_ALT)" VMODE="climb"/>
      <deroute BLOCK="circlehome"/>
    </block>
    <block NAME="circlehome">
      <exception COND="(RcEvent1())" DEROUTE="circuit"/>
      <circle WP="HOME" RADIUS="-50"/>
    </block>
    <block name="survey">
       <survey sector="airexpo" grid="100"/>
    </block>
    <block name="circuit">
      <exception COND="(RcEvent1())" DEROUTE="circlehome"/>
      <go wp="NW" FROM="TX_E" hmode="route" approaching_time="1"/>
      <go wp="TX_W" approaching_time="1"/>
      <go wp="TX_E" from="TX_W" hmode="route"/>
      <deroute block="circlehome"/>
    </block>
  </blocks>
</flight_plan>
