<airframe name="Microjet4">
 <!-- tiny test airframe -->

<!-- commands section -->
  <servos>
    <servo name="GAZ"           no="0" min="1000" neutral="1000" max="2000"/>
    <servo name="AILEVON_LEFT"  no="1" min="2000" neutral="1500" max="1000"/>
    <servo name="AILEVON_RIGHT" no="2" min="1000" neutral="1500" max="2000"/>
  </servos>

  <commands>
    <axis name="THROTTLE" failsafe_value="0"/>
    <axis name="ROLL"     failsafe_value="0"/>
    <axis name="PITCH"    failsafe_value="0"/>
  </commands>

  <rc_commands>
    <set command="THROTTLE" value="@THROTTLE"/>
    <set command="ROLL"     value="@ROLL"/>
    <set command="PITCH"    value="@PITCH"/>
  </rc_commands>

  <section name="MIXER">
    <define name="AILEVON_AILERON_RATE" value="0.55"/>
    <define name="AILEVON_ELEVATOR_RATE" value="0.75"/>
  </section>

  <command_laws>
    <let var="aileron"  value="@ROLL  * AILEVON_AILERON_RATE"/>
    <let var="elevator" value="@PITCH * AILEVON_ELEVATOR_RATE"/>  
    <set servo="GAZ"           value="@THROTTLE"/>
    <set servo="AILEVON_LEFT"  value="$elevator + $aileron"/>
    <set servo="AILEVON_RIGHT" value="$elevator - $aileron"/>
  </command_laws>

 <makefile>
include $(PAPARAZZI_SRC)/conf/autopilot/tiny.makefile

ap.srcs += commands.c

ap.CFLAGS += -DACTUATORS=\"servos_4015_hw.h\" -DSERVOS_4015
ap.srcs += $(SRC_ARCH)/servos_4015_hw.c

ap.CFLAGS += -DRADIO_CONTROL
ap.srcs += radio_control.c $(SRC_ARCH)/ppm_hw.c  

ap.CFLAGS += -DDOWNLINK -DUSE_UART0 -DDOWNLINK_TRANSPORT=PprzTransport -DDOWNLINK_FBW_DEVICE=Uart0 -DDOWNLINK_AP_DEVICE=Uart0
ap.srcs += downlink.c pprz_transport.c $(SRC_ARCH)/uart_hw.c

ap.CFLAGS += -DINTER_MCU
ap.srcs += inter_mcu.c 

ap.CFLAGS += -DGPS -DUBX -DUSE_UART1 -DGPS_LINK=Uart1
ap.srcs += gps_ubx.c gps.c

  </makefile>
</airframe>
