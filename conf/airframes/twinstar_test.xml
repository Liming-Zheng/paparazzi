<airframe name="TwinTest">
  <servos>
    <servo name="GAZ" no="9" min="1000" neutral="1000" max="2000"/>
    <servo name="AILERON_LEFT" no="2" min="1100" neutral="1492" max="2000"/>
    <servo name="AILERON_RIGHT" no="6" min="1000" neutral="1385" max="1833"/>
    <servo name="ELEVATOR" no="7" min="1000" neutral="1500" max="2000"/>
    <servo name="RUDDER"   no="3" min="1270" neutral="1546" max="1850"/>
  </servos>

  <commands>
    <axis name="THROTTLE" failsafe_value="9600"/>
    <axis name="ROLL"     failsafe_value="20"/>
    <axis name="PITCH"    failsafe_value="9600"/>
    <axis name="YAW"      failsafe_value="0"/>
  </commands>

<!--
<control>
  <mode name="MANUAL">
    <control type="direct" input="RADIO_THROTTLE" output="COMMAND_THROTTLE"/>
    <control type="direct" input="RADIO_ROLL" output="COMMAND_ROLL"/>
    <control type="direct" input="RADIO_PITCH" output="COMMAND_PITCH"/>
    <control type="direct" input="RADIO_YAW" output="COMMAND_YAW"/>
  </mode>

  <mode name="AUTO1">
    <control type="direct" input="RADIO_THROTTLE" output="COMMAND_THROTTLE"/>
    <control type="P" setpoint="RADIO_ROLL" measure="estimator_roll" output="COMMAND_ROLL"/>
    <control type="P" setpoint="RADIO_PITCH" measure="estimator_pitch" output="COMMAND_PITCH"/>
    <control type="direct" input="RADIO_YAW" output="COMMAND_YAW"/>
  </mode>

  <mode name="AUTO2">
    <control type="nav" output="COMMAND_THROTTLE"/>
    <control type="nav" output="COMMAND_ROLL"/>
    <control type="nav" output="COMMAND_PITCH"/>
    <control type="direct" input="RADIO_YAW" output="COMMAND_YAW"/>
  </mode>
</control>
 -->


  <section name="MIXER">
    <define name="AILERON_DIFF" value="0.66"/>
    <define name="COMBI_SWITCH" value="1.0"/>
  </section>

  <command_laws>
    <set servo="GAZ" value="@THROTTLE"/>
    <set servo="ELEVATOR" value="@PITCH"/>
    <let var="roll" value="@ROLL"/>
    <set servo="AILERON_LEFT" value="($roll > 0 ? 1 : AILERON_DIFF) * $roll"/>
    <set servo="AILERON_RIGHT" value="($roll > 0 ? AILERON_DIFF : 1) * $roll"/>
    <set servo="RUDDER" value="@YAW + @ROLL*COMBI_SWITCH"/>
  </command_laws>
  <makefile>
include $(PAPARAZZI_SRC)/conf/autopilot/test_v1_2_1.makefile
fbw.CFLAGS += -DRADIO_CONTROL 
fbw.srcs += radio_control.c $(SRC_ARCH)/ppm_hw.c control_2.c
  </makefile>
</airframe>
