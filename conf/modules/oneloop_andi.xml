<!DOCTYPE module SYSTEM "module.dtd">
<module name="oneloop_andi" dir="oneloop" task="control">
  <doc>
    <description>One loop (Guidance + Stabilization) ANDI controller for the rotating wing drone RW3C</description>
  </doc>
  <settings>
   <dl_settings>
     <dl_settings NAME="oneloop">
       <dl_setting var="p1_att"         min="0.0"     step="0.001" max="60.0"   shortname="p1_att"/>
       <dl_setting var="p1_head"        min="0.0"     step="0.001" max="60.0"   shortname="p1_head"/>
       <dl_setting var="p1_pos_1"       min="0.0"     step="0.001" max="60.0"   shortname="p1_pos_1"/>
       <dl_setting var="p1_pos_2"       min="0.0"     step="0.001" max="60.0"   shortname="p1_pos_2"/>
       <dl_setting var="p1_alt"         min="0.0"     step="0.001" max="60.0"   shortname="p1_alt"/>
       <dl_setting var="pos_init[0]"    min="-10.0"   step="0.001" max="10.0"   shortname="Pos_N"/>
       <dl_setting var="pos_init[1]"    min="-10.0"   step="0.001" max="10.0"   shortname="Pos_E"/>
       <dl_setting var="pos_init[2]"    min="-10.0"   step="0.001" max="0.0"    shortname="Pos_D"/>
       <dl_setting var="v_nav_des"      min="0.0"     step="0.001" max="15.0"    shortname="nav_vel"/>
       <dl_setting var="psi_des_deg"    min="-180.0"  step="0.1"   max="180.0"   shortname="psi_des"/>
       <dl_setting var="heading_on"     min="0"       step="1"     max="1"      values="OFF|ON" shortname="heading_on"/>
       <dl_setting var="w_scale"        min="0.2"     step="0.001" max="3.0"    shortname="w_scale"/>
       <dl_setting var="rm_k_attitude"  min="0.01"    step="0.001" max="10.0"    shortname="rm_k_attitude"/>
       <dl_setting var="pusher_test_on"     min="0"       step="1"     max="1"      values="OFF|ON" shortname="pusher_test"/>
       <dl_setting var="pusher_max_f"         min="0.0"     step="0.001" max="60.0"   shortname="pusher_max_f"/>
       <dl_setting var="oval_on"        min="0"       step="1"     max="1"      values="OFF|ON" shortname="oval"/>
       <dl_setting var="r_oval"         min="0.0"     step="0.001" max="15.0"    shortname="r_oval"/>
       <dl_setting var="l_oval"         min="0.0"     step="0.001" max="15.0"    shortname="l_oval"/>
     </dl_settings>
   </dl_settings>
  </settings>
  <dep>
    <depends>stabilization_rotorcraft,@attitude_command,wls</depends>
    <provides>commands</provides>
  </dep>
  <header>
    <file name="oneloop_andi.h"/>
  </header>
  <init fun="oneloop_andi_init()"/>
   <makefile target="ap|nps" firmware="rotorcraft">
    <file       name="oneloop_andi.c" dir="$(SRC_FIRMWARE)/oneloop"/>
    <file       name="wls_alloc.c" dir="$(SRC_FIRMWARE)/oneloop/wls"/>
    <file       name="qr_solve.c" dir="math/qr_solve"/>
    <file       name="r8lib_min.c" dir="math/qr_solve"/>
    <configure  name="ANDI_OUTPUTS" default="4"/>
    <configure  name="ANDI_NUM_ACT" default="4"/>
    <configure  name="ANDI_NUM_VIRTUAL_ACT" default="2"/>
    <configure  name="ANDI_NUM_ACT_TOT" default="6"/>
    <define     name="ANDI_OUTPUTS" value="$(ANDI_OUTPUTS)"/>
    <define     name="ANDI_NUM_ACT" value="$(ANDI_NUM_ACT)"/>
    <define     name="ANDI_NUM_VIRTUAL_ACT" value="$(ANDI_NUM_VIRTUAL_ACT)"/>
    <define     name="ANDI_NUM_ACT_TOT" value="$(ANDI_NUM_ACT_TOT)"/>
    <define     name="CA_N_V_ONELOOP" value="$(ANDI_OUTPUTS)"/>
    <define     name="CA_N_U_ONELOOP" value="$(ANDI_NUM_ACT_TOT)"/>
    <define     name="ONELOOP_ATTITUDE_ANDI_FULL" value="true"/>
  </makefile> 
</module>
